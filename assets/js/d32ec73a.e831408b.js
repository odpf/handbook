"use strict";(self.webpackChunkfirehose=self.webpackChunkfirehose||[]).push([[60],{3905:function(e,t,n){n.d(t,{Zo:function(){return s},kt:function(){return m}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),c=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},s=function(e){var t=c(e.components);return r.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),d=c(n),m=a,k=d["".concat(p,".").concat(m)]||d[m]||u[m]||o;return n?r.createElement(k,i(i({ref:t},s),{},{components:n})):r.createElement(k,i({ref:t},s))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var c=2;c<o;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6098:function(e,t,n){n.r(t),n.d(t,{assets:function(){return s},contentTitle:function(){return p},default:function(){return m},frontMatter:function(){return l},metadata:function(){return c},toc:function(){return u}});var r=n(7462),a=n(3366),o=(n(7294),n(3905)),i=["components"],l={},p="Project Structure Guidelines",c={unversionedId:"go/structure",id:"go/structure",title:"Project Structure Guidelines",description:"- Try to ensure every package has a file with same name as the package which acts as the entry point for anyone looking to understand the code. For example, post package should have post.go that defines the Post type, Store interface.",source:"@site/docs/go/structure.md",sourceDirName:"go",slug:"/go/structure",permalink:"/handbook/go/structure",draft:!1,editUrl:"https://github.com/odpf/handbook/edit/master/docs/docs/go/structure.md",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Overview",permalink:"/handbook/go/overview"},next:{title:"Style Guide",permalink:"/handbook/go/style_guide"}},s={},u=[{value:"<code>core/</code>",id:"core",level:2},{value:"<code>internal/</code>",id:"internal",level:2},{value:"<code>pkg/</code>",id:"pkg",level:2}],d={toc:u};function m(e){var t=e.components,n=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"project-structure-guidelines"},"Project Structure Guidelines"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Try to ensure every package has a file with same name as the package which acts as the entry point for anyone looking to understand the code. For example, ",(0,o.kt)("inlineCode",{parentName:"li"},"post")," package should have ",(0,o.kt)("inlineCode",{parentName:"li"},"post.go")," that defines the ",(0,o.kt)("inlineCode",{parentName:"li"},"Post")," type, ",(0,o.kt)("inlineCode",{parentName:"li"},"Store")," interface."),(0,o.kt)("li",{parentName:"ul"},"Try to ensure packages correspond to a specific domain and have well-defined responsibility. For example, prefer ",(0,o.kt)("inlineCode",{parentName:"li"},"post")," over ",(0,o.kt)("inlineCode",{parentName:"li"},"services/"),", etc."),(0,o.kt)("li",{parentName:"ul"},"Interfaces are defined on the client side (e.g., ",(0,o.kt)("inlineCode",{parentName:"li"},"ResourceStore")," interface is in ",(0,o.kt)("inlineCode",{parentName:"li"},"resource")," package along with the resource-service which is the actual user of the store.)."),(0,o.kt)("li",{parentName:"ul"},"Mocks for interfaces are defined close to the interface definition in an isolated ",(0,o.kt)("inlineCode",{parentName:"li"},"mocks/")," package.")),(0,o.kt)("h2",{id:"core"},(0,o.kt)("inlineCode",{parentName:"h2"},"core/")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"This dir should contain domain packages with well defined responsibility.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"For example, a blogging application could have ",(0,o.kt)("inlineCode",{parentName:"p"},"post"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"user"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"comment"),", etc. as the domain packages inside ",(0,o.kt)("inlineCode",{parentName:"p"},"core/"),".")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Generated mocks for dependency interfaces can be inside ",(0,o.kt)("inlineCode",{parentName:"p"},"mocks/")," package in the respective package. For example, ",(0,o.kt)("inlineCode",{parentName:"p"},"PostStore")," mock can be inside the ",(0,o.kt)("inlineCode",{parentName:"p"},"post")," package."),(0,o.kt)("table",null,(0,o.kt)("thead",null,(0,o.kt)("tr",null,(0,o.kt)("th",null,"Bad"),(0,o.kt)("th",null,"Good"))),(0,o.kt)("tbody",null,(0,o.kt)("tr",null,(0,o.kt)("td",null,(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-plaintext"},"+ core/\n|--+ service/\n|--+ models/\n"))),(0,o.kt)("td",null,(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-plaintext"},"+ core/\n|--+ post/\n|  |--+ mocks/\n|  |--+ post.go\n|--+ user/\n|--+ comment/\n")))))))),(0,o.kt)("h2",{id:"internal"},(0,o.kt)("inlineCode",{parentName:"h2"},"internal/")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"This should be used for keeping packages that should not be imported by any other projects (e.g., ",(0,o.kt)("inlineCode",{parentName:"p"},"server"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"store"),", etc.)"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-plaintext"},"|--+ internal/\n|  |--+ server/\n|  |  |--+ v1/\n|  |  |  |--+ read.go           {read api handlers (example only)}\n|  |  |  |--+ write.go          {write api handlers (example only)}\n|  |  |--+ server.go            {server setup, Serve() function, etc.}\n|  |--+ store/\n|  |  |--+ mongodb              {implement store interfaces using MongoDB}\n|  |  |--+ inmemory             {implement store interfaces using MongoDB}\n")))),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u26a0\ufe0f Note: ",(0,o.kt)("inlineCode",{parentName:"p"},"internal/")," has a special implication for the Go compiler. Any package inside ",(0,o.kt)("inlineCode",{parentName:"p"},"internal/")," will NOT be importable outside the go-module that contains it. ",(0,o.kt)("a",{parentName:"p",href:"https://go.dev/doc/go1.4#internalpackages"},"Reference"))),(0,o.kt)("h2",{id:"pkg"},(0,o.kt)("inlineCode",{parentName:"h2"},"pkg/")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"pkg/")," for truly reusable packages."),(0,o.kt)("li",{parentName:"ul"},"Pakcages inside ",(0,o.kt)("inlineCode",{parentName:"li"},"pkg/")," ",(0,o.kt)("em",{parentName:"li"},"MUST NOT")," import from other packages outside of ",(0,o.kt)("inlineCode",{parentName:"li"},"pkg/"),"."),(0,o.kt)("li",{parentName:"ul"},"Another way to think of ",(0,o.kt)("inlineCode",{parentName:"li"},"pkg/")," is: It is a container for packages that can be extracted into a separate re-usable library.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-plaintext"},"|--+ pkg/\n|  |--+ logger/\n|  |--+ telemetry/                  {NR, StatsD, opencensus integrations}\n")))}m.isMDXComponent=!0}}]);